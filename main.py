# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'untitled.ui'
#
# Created by: PyQt5 UI code generator 5.15.2
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.
import os
import st
from PyQt5 import QtCore, QtGui, QtWidgets
from PyQt5.QtCore import QTimer
from PyQt5.QtWidgets import QMessageBox, QInputDialog


class Ui_MainWindow(object):
    def setupUi(self, MainWindow):
        MainWindow.setObjectName("MainWindow")
        MainWindow.setEnabled(True)
        MainWindow.resize(400, 300)
        MainWindow.setMaximumSize(QtCore.QSize(400, 300))
        MainWindow.setCursor(QtGui.QCursor(QtCore.Qt.ArrowCursor))
        MainWindow.setMouseTracking(False)
        MainWindow.setTabletTracking(False)
        MainWindow.setAcceptDrops(False)
        MainWindow.setAutoFillBackground(False)
        MainWindow.setAnimated(False)
        MainWindow.setDocumentMode(False)
        MainWindow.setDockNestingEnabled(False)
        MainWindow.setUnifiedTitleAndToolBarOnMac(False)
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        self.centralwidget.setObjectName("centralwidget")
        self.groupBox = QtWidgets.QGroupBox(self.centralwidget)
        self.groupBox.setEnabled(True)
        self.groupBox.setGeometry(QtCore.QRect(10, 10, 155, 93))
        self.groupBox.setObjectName("groupBox")
        self.KeySR = QtWidgets.QLineEdit(self.groupBox)
        self.KeySR.setEnabled(True)
        self.KeySR.setGeometry(QtCore.QRect(10, 20, 133, 20))
        self.KeySR.setText("")
        self.KeySR.setEchoMode(QtWidgets.QLineEdit.Password)
        self.KeySR.setDragEnabled(True)
        self.KeySR.setCursorMoveStyle(QtCore.Qt.LogicalMoveStyle)
        self.KeySR.setClearButtonEnabled(True)
        self.KeySR.setObjectName("KeySR")
        self.KeyYZ = QtWidgets.QPushButton(self.groupBox)
        self.KeyYZ.setEnabled(True)
        self.KeyYZ.setGeometry(QtCore.QRect(10, 50, 61, 23))
        self.KeyYZ.setCursor(QtGui.QCursor(QtCore.Qt.PointingHandCursor))
        self.KeyYZ.setObjectName("KeyYZ")
        self.KeyGG = QtWidgets.QPushButton(self.groupBox)
        self.KeyGG.setEnabled(False)
        self.KeyGG.setGeometry(QtCore.QRect(104, 50, 41, 23))
        self.KeyGG.setCursor(QtGui.QCursor(QtCore.Qt.PointingHandCursor))
        self.KeyGG.setObjectName("KeyGG")
        self.groupBox_2 = QtWidgets.QGroupBox(self.centralwidget)
        self.groupBox_2.setEnabled(True)
        self.groupBox_2.setGeometry(QtCore.QRect(190, 9, 171, 93))
        self.groupBox_2.setObjectName("groupBox_2")
        self.layoutWidget = QtWidgets.QWidget(self.groupBox_2)
        self.layoutWidget.setEnabled(True)
        self.layoutWidget.setGeometry(QtCore.QRect(10, 20, 62, 22))
        self.layoutWidget.setObjectName("layoutWidget")
        self.horizontalLayout = QtWidgets.QHBoxLayout(self.layoutWidget)
        self.horizontalLayout.setContentsMargins(0, 0, 0, 0)
        self.horizontalLayout.setObjectName("horizontalLayout")
        self.label = QtWidgets.QLabel(self.layoutWidget)
        self.label.setEnabled(True)
        self.label.setObjectName("label")
        self.horizontalLayout.addWidget(self.label)
        self.SetS = QtWidgets.QSpinBox(self.layoutWidget)
        self.SetS.setEnabled(True)
        self.SetS.setObjectName("SetS")
        self.SetS.setMaximum(9999)
        self.horizontalLayout.addWidget(self.SetS)
        self.layoutWidget1 = QtWidgets.QWidget(self.groupBox_2)
        self.layoutWidget1.setEnabled(True)
        self.layoutWidget1.setGeometry(QtCore.QRect(10, 50, 62, 22))
        self.layoutWidget1.setObjectName("layoutWidget1")
        self.horizontalLayout_2 = QtWidgets.QHBoxLayout(self.layoutWidget1)
        self.horizontalLayout_2.setContentsMargins(0, 0, 0, 0)
        self.horizontalLayout_2.setObjectName("horizontalLayout_2")
        self.label_2 = QtWidgets.QLabel(self.layoutWidget1)
        self.label_2.setEnabled(True)
        self.label_2.setObjectName("label_2")
        self.horizontalLayout_2.addWidget(self.label_2)
        self.SetMin = QtWidgets.QSpinBox(self.layoutWidget1)
        self.SetMin.setEnabled(True)
        self.SetMin.setObjectName("SetMin")
        self.horizontalLayout_2.addWidget(self.SetMin)
        self.SetMin.setMaximum(9999)
        self.layoutWidget2 = QtWidgets.QWidget(self.groupBox_2)
        self.layoutWidget2.setEnabled(True)
        self.layoutWidget2.setGeometry(QtCore.QRect(80, 20, 62, 22))
        self.layoutWidget2.setObjectName("layoutWidget2")
        self.horizontalLayout_3 = QtWidgets.QHBoxLayout(self.layoutWidget2)
        self.horizontalLayout_3.setContentsMargins(0, 0, 0, 0)
        self.horizontalLayout_3.setObjectName("horizontalLayout_3")
        self.label_3 = QtWidgets.QLabel(self.layoutWidget2)
        self.label_3.setEnabled(True)
        self.label_3.setObjectName("label_3")
        self.horizontalLayout_3.addWidget(self.label_3)
        self.SetH = QtWidgets.QSpinBox(self.layoutWidget2)
        self.SetH.setEnabled(True)
        self.SetH.setObjectName("SetDay")
        self.horizontalLayout_3.addWidget(self.SetH)
        self.SetH.setMaximum(9999)
        self.lcdNumber = QtWidgets.QLCDNumber(self.groupBox_2)
        self.lcdNumber.setEnabled(True)
        self.lcdNumber.setGeometry(QtCore.QRect(80, 50, 81, 23))
        self.lcdNumber.setSmallDecimalPoint(False)
        self.lcdNumber.setDigitCount(9)
        self.lcdNumber.setSegmentStyle(QtWidgets.QLCDNumber.Flat)
        self.lcdNumber.setProperty("value", 0.0)
        self.lcdNumber.setProperty("intValue", 0)
        self.lcdNumber.setObjectName("lcdNumber")
        self.groupBox_3 = QtWidgets.QGroupBox(self.centralwidget)
        self.groupBox_3.setEnabled(True)
        self.groupBox_3.setGeometry(QtCore.QRect(10, 110, 155, 83))
        self.groupBox_3.setObjectName("groupBox_3")
        self.CC = QtWidgets.QLineEdit(self.groupBox_3)
        self.CC.setEnabled(True)
        self.CC.setGeometry(QtCore.QRect(10, 20, 133, 20))
        self.CC.setText("")
        self.CC.setMaxLength(512)
        self.CC.setDragEnabled(False)
        self.CC.setClearButtonEnabled(True)
        self.CC.setObjectName("CC")
        self.Cbj = QtWidgets.QPushButton(self.groupBox_3)
        self.Cbj.setEnabled(True)
        self.Cbj.setGeometry(QtCore.QRect(90, 50, 51, 23))
        self.Cbj.setObjectName("Cbj")
        self.groupBox_4 = QtWidgets.QGroupBox(self.centralwidget)
        self.groupBox_4.setEnabled(True)
        self.groupBox_4.setGeometry(QtCore.QRect(190, 110, 146, 80))
        self.groupBox_4.setObjectName("groupBox_4")
        self.layoutWidget3 = QtWidgets.QWidget(self.groupBox_4)
        self.layoutWidget3.setEnabled(True)
        self.layoutWidget3.setGeometry(QtCore.QRect(10, 20, 126, 46))
        self.layoutWidget3.setObjectName("layoutWidget3")
        self.gridLayout = QtWidgets.QGridLayout(self.layoutWidget3)
        self.gridLayout.setContentsMargins(0, 0, 0, 0)
        self.gridLayout.setObjectName("gridLayout")
        self.radioCQGJ = QtWidgets.QRadioButton(self.layoutWidget3)
        self.radioCQGJ.setEnabled(True)
        self.radioCQGJ.setObjectName("radioCQGJ")
        self.gridLayout.addWidget(self.radioCQGJ, 0, 1, 1, 1)
        self.radioCQ = QtWidgets.QRadioButton(self.layoutWidget3)
        self.radioCQ.setEnabled(True)
        self.radioCQ.setObjectName("radioCQ")
        self.gridLayout.addWidget(self.radioCQ, 1, 0, 1, 1)
        self.radioGJ = QtWidgets.QRadioButton(self.layoutWidget3)
        self.radioGJ.setEnabled(True)
        self.radioGJ.setObjectName("radioGJ")
        self.gridLayout.addWidget(self.radioGJ, 0, 0, 1, 1)
        self.radioGJQD = QtWidgets.QRadioButton(self.layoutWidget3)
        self.radioGJQD.setEnabled(True)
        self.radioGJQD.setObjectName("radioGJQD")
        self.gridLayout.addWidget(self.radioGJQD, 1, 1, 1, 1)
        self.groupBox_5 = QtWidgets.QGroupBox(self.centralwidget)
        self.groupBox_5.setEnabled(False)
        self.groupBox_5.setGeometry(QtCore.QRect(10, 200, 95, 93))
        self.groupBox_5.setObjectName("groupBox_5")
        self.GB = QtWidgets.QPushButton(self.groupBox_5)
        self.GB.setGeometry(QtCore.QRect(10, 20, 75, 23))
        self.GB.setObjectName("GB")
        self.QX = QtWidgets.QPushButton(self.groupBox_5)
        self.QX.setGeometry(QtCore.QRect(10, 50, 75, 23))
        self.QX.setObjectName("QX")
        self.pushButton_4 = QtWidgets.QPushButton(self.centralwidget)
        self.pushButton_4.setGeometry(QtCore.QRect(310, 260, 75, 23))
        self.pushButton_4.setAutoDefault(True)
        self.pushButton_4.setDefault(True)
        self.pushButton_4.setFlat(False)
        self.pushButton_4.setObjectName("pushButton_4")
        # æˆ‘æ‰ä¸ä¼šå‘Šè¯‰ä½ ï¼Œè¿™æ˜¯ä¸‹æ¬¡æ›´æ–°çš„å†…å®¹ï¼Œæ˜¯é¢„è§ˆæ—¶é—´
        '''self.groupBox_6 = QtWidgets.QGroupBox(self.centralwidget)
        self.groupBox_6.setEnabled(True)
        self.groupBox_6.setGeometry(QtCore.QRect(120, 200, 181, 91))
        self.groupBox_6.setObjectName("groupBox_6")'''
        '''self.label_4 = QtWidgets.QLabel(self.groupBox_6)
        self.label_4.setGeometry(QtCore.QRect(10, 20, 54, 21))
        self.label_4.setObjectName("label_4")'''
        '''self.tim = QtWidgets.QLineEdit(self.groupBox_6)
        self.tim.setGeometry(QtCore.QRect(60, 20, 111, 20))
        self.tim.setReadOnly(True)
        self.tim.setObjectName("tim")'''
        MainWindow.setCentralWidget(self.centralwidget)

        self.retranslateUi(MainWindow)
        self.pushButton_4.clicked.connect(self.about)
        self.KeyYZ.clicked.connect(self.verification)
        self.Cbj.clicked.connect(self.Edit_Comment)
        self.KeyGG.clicked.connect(self.Change_key)
        self.QX.clicked.connect(self.canceler)
        self.GB.clicked.connect(self.Shutdown)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

        # è®¡æ—¶å™¨ # ç³»LCDæ•°å­—æ˜¾ç¤º
        self.timerA = QTimer(MainWindow)

        self.timerA.timeout.connect(self.TIME)

    def Shutdown(self):
        Cé”™è¯¯ = False
        Cè¶…å‰æ—¶é—´ = self.lcdNumber.value()
        Zæ³¨é‡Š = self.CC.text()

        ok = QMessageBox.question(MainWindow, 'é—®é¢˜', 'ç¡®å®šå—ï¼Ÿ', QMessageBox.Yes | QMessageBox.No)
        if ok == QMessageBox.No:
            Cé”™è¯¯ = True

        if Cè¶…å‰æ—¶é—´ == 0.0:
            ko = QMessageBox.question(MainWindow, 'é—®é¢˜', 'è¶…å‰æ—¶é—´ä¸º0ç§’\nä¼šé©¬ä¸Šå…³é—­ï¼Œç¡®å®šå—ï¼Ÿ', QMessageBox.Yes | QMessageBox.No)
            if ko == QMessageBox.No:
                Cé”™è¯¯ = True

        if self.radioGJ.isChecked():
            CMDæ‰§è¡Œ = '-s'

        if self.radioCQ.isChecked():
            CMDæ‰§è¡Œ = '-r'

        if self.radioCQGJ.isChecked():
            CMDæ‰§è¡Œ = '-r -o'

        if self.radioGJQD.isChecked():
            CMDæ‰§è¡Œ = '-s -fw'

        try:
            print(CMDæ‰§è¡Œ)
        except UnboundLocalError:
            QMessageBox.critical(MainWindow, 'å…³é”®æ€§ç»ˆæ­¢', 'æ²¡æœ‰è®¾ç½®æ‰§è¡Œä»»åŠ¡')
            Cé”™è¯¯ = True

        print(Zæ³¨é‡Š)

        if Zæ³¨é‡Š == '':
            CMDæ³¨é‡Š = ''
        else:
            CMDæ³¨é‡Š = '-c ' + Zæ³¨é‡Š

        Cè¶…å‰æ—¶é—´ = int(Cè¶…å‰æ—¶é—´)

        if not Cé”™è¯¯:
            print('Shutdown ' + CMDæ‰§è¡Œ + ' ' + '-t ' + str(Cè¶…å‰æ—¶é—´) + '' + CMDæ³¨é‡Š)
            os.system('Shutdown ' + CMDæ‰§è¡Œ + ' ' + '-t ' + str(Cè¶…å‰æ—¶é—´) + ' ' + CMDæ³¨é‡Š)

    def TIME(self):
        ç§’ = self.SetS.value()
        åˆ† = self.SetMin.value()
        æ—¶ = self.SetH.value()

        ç§’ = ç§’ + åˆ† * 60 + æ—¶ * 60 * 60

        self.lcdNumber.setProperty('value', ç§’)
        self.lcdNumber.setProperty('value', ç§’)

    def canceler(self):  # å–æ¶ˆå…³é—­
        os.system('Shutdown -a')
        QMessageBox.information(MainWindow, 'ä¿¡æ¯', 'å·²ç»å–æ¶ˆå½“å‰å…³é—­\n(å¦‚æœå¯èƒ½)')

    def Change_key(self):  # æ›´æ”¹å¯†é’¥
        ok = QMessageBox.question(MainWindow, 'æé—®', 'ç¡®è®¤æ›´æ”¹?', QMessageBox.Yes | QMessageBox.No)
        if ok == QMessageBox.Yes:
            text, ok = QInputDialog.getText(MainWindow, 'è®¾ç½®', 'è®¾ç½®æ–°çš„ key\nè¯·ä¸è¦è¾“å…¥ä¸­æ–‡å› ä¸ºæ— æ³•è¾“å…¥\nä¿ç•™å­—"None_"ç­‰äºç©º')
            if ok:
                s = '''[PW]
password:''' + text
                setting = open('setting.ini', 'w', encoding='utf-8')
                setting.write(s)
                setting.close()

    def Edit_Comment(self):  # æ³¨é‡Šçª—å£
        text, ok = QInputDialog.getText(MainWindow, 'æ³¨é‡Š', 'è®¾ç½®æ³¨é‡Š', )
        if ok:
            self.CC.setText(text)

    def about(self):  # å…³äº
        QMessageBox.about(MainWindow, 'å…³äº', 'ä½œè€…:ğ“’ğ“¸ğ“¸ğ“µ ğ“–ğ“¾ğ“ªğ“·ğ“°ğ“´ğ“¾ğ“·\nç‰ˆæœ¬:1.2\næå‡ºçš„å»ºè®®è¯·åœ¨ liang2457@qq.com \né‚®ç®±ä¸Šè¯‰è¯´')

    def verification(self):  # éªŒè¯key
        key = self.KeySR.text()
        password = st.setting()
        _wz = password.find('password')
        password = password[_wz:]
        password = password.partition(':')
        password = password[2:]
        password = str(password)
        password = password[2:-3]

        if password == 'None_':
            password = ''

        if not key == password:
            QMessageBox.critical(MainWindow, 'é”™è¯¯', 'éªŒè¯é”™è¯¯')
        else:
            self.KeyGG.setEnabled(True)
            self.GB.setEnabled(True)
            self.QX.setEnabled(True)
            self.groupBox_5.setEnabled(True)
            self.KeyYZ.setEnabled(False)
            self.KeySR.setText('')
            self.KeySR.setPlaceholderText('éªŒè¯æ­£ç¡®')
            self.KeySR.setEnabled(False)
            self.timerA.start(100)

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "å®šæ—¶å…³æœº"))
        self.groupBox.setTitle(_translate("MainWindow", "key"))
        self.KeySR.setPlaceholderText(_translate("MainWindow", "è¯·è¾“å…¥ key ç»§ç»­"))
        self.KeyYZ.setText(_translate("MainWindow", "éªŒè¯"))
        self.KeyGG.setText(_translate("MainWindow", "æ›´æ”¹"))
        self.groupBox_2.setTitle(_translate("MainWindow", "æ—¶é—´è®¾ç½®"))
        self.label.setText(_translate("MainWindow", "ç§’"))
        self.label_2.setText(_translate("MainWindow", "åˆ†"))
        self.label_3.setText(_translate("MainWindow", "æ—¶"))
        self.groupBox_3.setTitle(_translate("MainWindow", "æ³¨é‡Š"))
        self.CC.setPlaceholderText(_translate("MainWindow", "æœ‰å…³å…³æœº/é‡å¯çš„æ³¨é‡Š"))
        self.Cbj.setText(_translate("MainWindow", "ç¼–è¾‘"))
        self.groupBox_4.setTitle(_translate("MainWindow", "æ‰§è¡Œ"))
        self.radioCQGJ.setText(_translate("MainWindow", "å¯åŠ¨å›ºä»¶"))
        self.radioCQ.setText(_translate("MainWindow", "é‡å¯"))
        self.radioGJ.setText(_translate("MainWindow", "å…³æœº"))
        self.radioGJQD.setText(_translate("MainWindow", "é«˜çº§å¯åŠ¨"))
        self.groupBox_5.setTitle(_translate("MainWindow", "ç¡®è®¤"))
        self.GB.setText(_translate("MainWindow", "å…³é—­"))
        self.QX.setText(_translate("MainWindow", "å–æ¶ˆ"))
        self.pushButton_4.setText(_translate("MainWindow", "å…³äº"))


if __name__ == '__main__':
    import sys

    app = QtWidgets.QApplication(sys.argv)
    MainWindow = QtWidgets.QMainWindow()
    ui = Ui_MainWindow()
    ui.setupUi(MainWindow)
    MainWindow.show()
    sys.exit(app.exec_())
